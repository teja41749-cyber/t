version: "3.1"

intents:
  - affirm
  - deny
  - clarify
  - modify_relationship
  - add_class
  - remove_class
  - modify_class
  - add_attribute
  - remove_attribute
  - add_method
  - remove_method
  - export_diagram
  - get_help
  - show_context
  - confirm_change
  - cancel_change

entities:
  - relationship_type
  - class_name
  - attribute_name
  - method_name
  - multiplicity
  - visibility
  - data_type
  - export_format

slots:
  current_context:
    type: categorical
    values:
      - relationship_validation
      - class_modification
      - attribute_modification
      - method_modification
      - export_request

  target_class:
    type: text
    influence_conversation: true

  target_relationship:
    type: text
    influence_conversation: true

  modification_type:
    type: categorical
    values:
      - relationship
      - class
      - attribute
      - method
    influence_conversation: true

responses:
  utter_greet:
    - text: "Hello! I'm here to help you refine your UML diagram. I've analyzed your requirements and extracted an initial diagram. Let me know if you have any questions about the relationships or want to make changes."
    - text: "Hi! I'm your UML diagram assistant. I've created an initial diagram from your requirements. I can help you validate relationships, add/remove classes, and refine the diagram structure."

  utter_ask_relationship_type:
    - text: "I found a relationship between {source_class} and {target_class}. What type of relationship should this be?"
      buttons:
        - title: "Composition"
          payload: '/clarify{{"relationship_type": "composition"}}'
        - title: "Association"
          payload: '/clarify{{"relationship_type": "association"}}'
        - title: "Aggregation"
          payload: '/clarify{{"relationship_type": "aggregation"}}'
        - title: "Inheritance"
          payload: '/clarify{{"relationship_type": "inheritance"}}'
        - title: "Remove"
          payload: '/remove_class{{"class_name": "{target_class}"}}'

  utter_ask_multiplicity:
    - text: "What should be the multiplicity for the {relationship_type} relationship between {source_class} and {target_class}?"
      buttons:
        - title: "1 to 1"
          payload: '/modify_relationship{{"multiplicity": "1..1"}}'
        - title: "1 to many"
          payload: '/modify_relationship{{"multiplicity": "1..*"}}'
        - title: "Many to many"
          payload: '/modify_relationship{{"multiplicity": "*..*"}}'
        - title: "Optional"
          payload: '/modify_relationship{{"multiplicity": "0..1"}}'

  utter_ask_class_addition:
    - text: "What class would you like to add to the diagram?"
    - text: "Please provide the name of the class you want to add."

  utter_ask_class_modification:
    - text: "What would you like to change about the {class_name} class?"
      buttons:
        - title: "Add attribute"
          payload: '/add_attribute{{"class_name": "{class_name}"}}'
        - title: "Add method"
          payload: '/add_method{{"class_name": "{class_name}"}}'
        - title: "Remove attribute"
          payload: '/remove_attribute{{"class_name": "{class_name}"}}'
        - title: "Remove method"
          payload: '/remove_method{{"class_name": "{class_name}"}}'
        - title: "Rename class"
          payload: '/modify_class{{"modification": "rename"}}'

  utter_ask_attribute_details:
    - text: "What should be the name of the {data_type} attribute for {class_name}?"
    - text: "Please specify the attribute name and data type (e.g., 'username: String')."

  utter_ask_method_details:
    - text: "What should be the name and parameters of the method for {class_name}?"
    - text: "Please specify the method signature (e.g., 'login(username, password): Boolean')."

  utter_confirm_change:
    - text: "I'll {action} the {target}. Is this correct?"
      buttons:
        - title: "Yes, proceed"
          payload: '/confirm_change'
        - title: "No, cancel"
          payload: '/cancel_change'

  utter_change_applied:
    - text: "Great! I've {action} the {target}. The diagram has been updated."
    - text: "Done! The {target} has been {action}. You can see the updated diagram now."

  utter_ask_export_format:
    - text: "In what format would you like to export your diagram?"
      buttons:
        - title: "Mermaid"
          payload: '/export_diagram{{"export_format": "mermaid"}}'
        - title: "JSON"
          payload: '/export_diagram{{"export_format": "json"}}'
        - title: "SVG (Coming soon)"
          payload: '/export_diagram{{"export_format": "svg"}}'

  utter_provide_help:
    - text: "I can help you with the following tasks:"
      bullets:
        - "Validate relationships between classes"
        - "Add or remove classes"
        - "Add attributes and methods to classes"
        - "Change relationship types (composition, association, etc.)"
        - "Export your diagram in different formats"
    - text: "Just tell me what you'd like to do, or ask me to explain any part of your diagram."

  utter_show_context:
    - text: "Currently, your diagram has {class_count} classes and {relationship_count} relationships. The main classes are: {main_classes}."
    - text: "Your UML diagram contains {class_count} classes. I'm ready to help you refine it further."

  utter_default:
    - text: "I'm not sure I understand. Could you please clarify what you'd like to do with your UML diagram?"
    - text: "I can help you modify your diagram - would you like to add classes, change relationships, or export the diagram?"

  utter_goodbye:
    - text: "Great! I've helped you refine your UML diagram. Feel free to come back if you need to make any more changes."
    - text: "Your UML diagram looks good now! Let me know if you need any further assistance."

actions:
  - action_validate_relationship
  - action_modify_diagram
  - action_add_class
  - action_remove_class
  - action_add_attribute
  - action_add_method
  - action_export_diagram
  - action_show_context
  - action_provide_help

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true